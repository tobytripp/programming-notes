<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Code Alchemy</title>
<!-- 2015-02-22 Sun 12:26 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Toby Tripp" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" href="css/style.css">
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Code Alchemy</h1>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Skyrim Potion Mixing</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Prolog</h3>
<div class="outline-text-3" id="text-1-1">
<p>
A general-purpose logic programming language developed in 1972.
</p>

<p>
Abbreviation of "Programming with Logic"
</p>

<ul class="org-ul">
<li>implication <code>:-</code>
</li>
<li>conjunction ,
</li>
<li>disjunction <code>;</code>
</li>
<li>variable    <code>Var</code>
</li>
<li>atom        <code>var</code>
</li>
<li>number      <code>2</code>
</li>
</ul>
</div>

<div id="outline-container-sec-1-1-1" class="outline-4">
<h4 id="sec-1-1-1">Atoms</h4>
<div class="outline-text-4" id="text-1-1-1">
<div class="org-src-container">

<pre class="src src-prolog">1.                              <span style="color: #586e75;">% numbers</span>
atom.                           <span style="color: #586e75;">% simple</span>
<span style="color: #2aa198;">'an atom'</span>.                      <span style="color: #586e75;">% quoted</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-2" class="outline-4">
<h4 id="sec-1-1-2">Variables</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
Begin with an Upper-case letter.
</p>
<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #268bd2;">X</span>.
<span style="color: #268bd2;">X1</span>.
<span style="color: #268bd2;">C_3</span>.
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-3" class="outline-4">
<h4 id="sec-1-1-3">Facts</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
Facts can be considered to be Rules with no Body, i.e., a Rule
whose antecedent conditions are empty and therefore always true.
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #268bd2;">cat</span><span style="color: #f5deb3;">(</span> sylvester <span style="color: #f5deb3;">)</span> :- true.    <span style="color: #586e75;">% also called a `complex term`</span>
<span style="color: #268bd2;">cat</span><span style="color: #f5deb3;">(</span> tom <span style="color: #f5deb3;">)</span>.                  <span style="color: #586e75;">% synonymous with above</span>

<span style="color: #268bd2;">dog</span><span style="color: #f5deb3;">(</span> bill <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">mouse</span><span style="color: #f5deb3;">(</span> jerry <span style="color: #f5deb3;">)</span>.
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-1-1-4" class="outline-4">
<h4 id="sec-1-1-4">Rules</h4>
<div class="outline-text-4" id="text-1-1-4">
<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #268bd2;">animal</span><span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">X</span> <span style="color: #f5deb3;">)</span> :- cat<span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">X</span> <span style="color: #f5deb3;">)</span>.     <span style="color: #586e75;">% Given X is a cat,</span>
                             <span style="color: #586e75;">% X is an animal.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-5" class="outline-4">
<h4 id="sec-1-1-5">Terms may be recursive</h4>
<div class="outline-text-4" id="text-1-1-5">
<p>
Does this <i>unify</i>?
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #586e75;">% </span><span style="color: #586e75;">`=` is Prolog's unification operator.</span>
<span style="color: #268bd2;">father</span><span style="color: #f5deb3;">(</span><span style="color: #268bd2;">X</span><span style="color: #f5deb3;">)</span>  =  <span style="color: #268bd2;">X</span>.
</pre>
</div>

<p>
Yes, it does.
</p>

<p>
To what?
</p>

<p>
â€¦it depends. The expression is defined to be unifiable, but its
display is implementation-dependent. <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup>
</p>


<p>
What is displayed will vary based on the prolog implementation, but
any of them will allow the query to unify.
</p>

<p>
SWI-Prolog will answer
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #268bd2;">X</span> = father<span style="color: #f5deb3;">(</span><span style="color: #268bd2;">X</span><span style="color: #f5deb3;">)</span>.
</pre>
</div>

<p>
gprolog will refuse to output the unification, but will still
return `yes`, indicating that the expression unified.
</p>

<p>
Other implementations may try to display it as something like:
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #268bd2;">X</span>  =  father<span style="color: #f5deb3;">(</span>father<span style="color: #b58900;">(</span>father<span style="color: #268bd2;">(</span>father<span style="color: #dc322f;">(</span>...<span style="color: #dc322f;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #f5deb3;">)</span><span style="color: #839496; background-color: #002b36;">))))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-6" class="outline-4">
<h4 id="sec-1-1-6">Queries</h4>
<div class="outline-text-4" id="text-1-1-6">
<div class="org-src-container">

<pre class="src src-prolog">?- cat<span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">X</span> <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">X</span> = sylvester
<span style="color: #268bd2;">X</span> = tom
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-7" class="outline-4">
<h4 id="sec-1-1-7">Lists</h4>
<div class="outline-text-4" id="text-1-1-7">
<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #f5deb3; font-weight: bold;">[</span>1, 2, a<span style="color: #f5deb3; font-weight: bold;">]</span>.
<span style="color: #f5deb3; font-weight: bold;">[</span>1, a<span style="color: #b58900;">(</span> 1, 2 <span style="color: #b58900;">)</span>, 3<span style="color: #f5deb3; font-weight: bold;">]</span>.
<span style="color: #f5deb3; font-weight: bold;">[</span><span style="color: #268bd2;">A</span>, b, c<span style="color: #f5deb3; font-weight: bold;">]</span>.

<span style="color: #859900; font-weight: bold;">|</span> ?- <span style="color: #f5deb3; font-weight: bold;">[</span>1,2,3<span style="color: #f5deb3; font-weight: bold;">]</span> = <span style="color: #f5deb3; font-weight: bold;">[</span><span style="color: #268bd2;">A</span><span style="color: #859900; font-weight: bold;">|</span><span style="color: #268bd2;">Tail</span><span style="color: #f5deb3; font-weight: bold;">]</span>.
<span style="color: #268bd2;">A</span> = 1
<span style="color: #268bd2;">Tail</span> = <span style="color: #f5deb3; font-weight: bold;">[</span>2,3<span style="color: #f5deb3; font-weight: bold;">]</span>

<span style="color: #859900; font-weight: bold;">|</span> ?- <span style="color: #f5deb3; font-weight: bold;">[</span>1,2,3<span style="color: #f5deb3; font-weight: bold;">]</span> = <span style="color: #f5deb3; font-weight: bold;">[</span><span style="color: #268bd2;">A</span><span style="color: #859900; font-weight: bold;">|</span><span style="color: #b58900; font-weight: bold;">[</span><span style="color: #268bd2;">B</span><span style="color: #859900; font-weight: bold;">|</span><span style="color: #268bd2;">Tail</span><span style="color: #b58900; font-weight: bold;">]</span><span style="color: #f5deb3; font-weight: bold;">]</span>.

<span style="color: #268bd2;">A</span> = 1
<span style="color: #268bd2;">B</span> = 2
<span style="color: #268bd2;">Tail</span> = <span style="color: #f5deb3; font-weight: bold;">[</span>3<span style="color: #f5deb3; font-weight: bold;">]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-8" class="outline-4">
<h4 id="sec-1-1-8">Append</h4>
<div class="outline-text-4" id="text-1-1-8">
<p>
Let's consider a definition of Prolog's append/3: <sup><a id="fnr.1.100" name="fnr.1.100" class="footref" href="#fn.1">1</a></sup>
</p>
<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #268bd2;">append</span><span style="color: #f5deb3;">(</span> <span style="color: #b58900; font-weight: bold;">[]</span>, <span style="color: #268bd2;">L</span>, <span style="color: #268bd2;">L</span> <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">append</span><span style="color: #f5deb3;">(</span> <span style="color: #b58900; font-weight: bold;">[</span><span style="color: #268bd2;">H</span><span style="color: #859900; font-weight: bold;">|</span><span style="color: #268bd2;">T</span><span style="color: #b58900; font-weight: bold;">]</span>, <span style="color: #268bd2;">L2</span>, <span style="color: #b58900; font-weight: bold;">[</span><span style="color: #268bd2;">H</span><span style="color: #859900; font-weight: bold;">|</span><span style="color: #268bd2;">L3</span><span style="color: #b58900; font-weight: bold;">]</span> <span style="color: #f5deb3;">)</span> :- append<span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">T</span>, <span style="color: #268bd2;">L2</span>, <span style="color: #268bd2;">L3</span> <span style="color: #f5deb3;">)</span>.
</pre>
</div>

<p>
Demonstrates the Head|Tail list deconstruction.
</p>

<p>
Read as:
  appending the empty list to any list L results in the list L.
</p>

<p>
when we append a non-empty list [H|T] with a list L2, we get
the list whose head is H and
whose tail is the result of appending T with L2 .
</p>
</div>
</div>


<div id="outline-container-sec-1-1-9" class="outline-4">
<h4 id="sec-1-1-9">Using Append</h4>
<div class="outline-text-4" id="text-1-1-9">
<p>
Because of the nature of logical programming, append/3
can be used to <i>break-up</i> lists:
</p>
<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #268bd2;">append</span><span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">X</span>, <span style="color: #268bd2;">Y</span>, <span style="color: #b58900; font-weight: bold;">[</span>a,b,c,d<span style="color: #b58900; font-weight: bold;">]</span> <span style="color: #f5deb3;">)</span>.

<span style="color: #268bd2;">X</span>  =  <span style="color: #f5deb3; font-weight: bold;">[]</span>
<span style="color: #268bd2;">Y</span>  =  <span style="color: #f5deb3; font-weight: bold;">[</span>a,b,c,d<span style="color: #f5deb3; font-weight: bold;">]</span>

<span style="color: #268bd2;">X</span>  =  <span style="color: #f5deb3; font-weight: bold;">[</span>a<span style="color: #f5deb3; font-weight: bold;">]</span>
<span style="color: #268bd2;">Y</span>  =  <span style="color: #f5deb3; font-weight: bold;">[</span>b,c,d<span style="color: #f5deb3; font-weight: bold;">]</span>

<span style="color: #268bd2;">X</span>  =  <span style="color: #f5deb3; font-weight: bold;">[</span>a,b<span style="color: #f5deb3; font-weight: bold;">]</span>
<span style="color: #268bd2;">Y</span>  =  <span style="color: #f5deb3; font-weight: bold;">[</span>c,d<span style="color: #f5deb3; font-weight: bold;">]</span>

<span style="color: #268bd2;">X</span>  =  <span style="color: #f5deb3; font-weight: bold;">[</span>a,b,c<span style="color: #f5deb3; font-weight: bold;">]</span>
<span style="color: #268bd2;">Y</span>  =  <span style="color: #f5deb3; font-weight: bold;">[</span>d<span style="color: #f5deb3; font-weight: bold;">]</span>

<span style="color: #268bd2;">X</span>  =  <span style="color: #f5deb3; font-weight: bold;">[</span>a,b,c,d<span style="color: #f5deb3; font-weight: bold;">]</span>
<span style="color: #268bd2;">Y</span>  =  <span style="color: #f5deb3; font-weight: bold;">[]</span>
</pre>
</div>

<p>
Goals in a logic language can be run <i>backward</i>.
</p>
</div>
</div>

<div id="outline-container-sec-1-1-10" class="outline-4">
<h4 id="sec-1-1-10">Permutation</h4>
<div class="outline-text-4" id="text-1-1-10">
<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #268bd2;">permutation</span><span style="color: #f5deb3;">(</span> <span style="color: #b58900; font-weight: bold;">[</span>1,2,3<span style="color: #b58900; font-weight: bold;">]</span>, <span style="color: #268bd2;">L</span> <span style="color: #f5deb3;">)</span>.

<span style="color: #268bd2;">L</span> = <span style="color: #f5deb3; font-weight: bold;">[</span>1,2,3<span style="color: #f5deb3; font-weight: bold;">]</span>
<span style="color: #268bd2;">L</span> = <span style="color: #f5deb3; font-weight: bold;">[</span>1,3,2<span style="color: #f5deb3; font-weight: bold;">]</span>
<span style="color: #268bd2;">L</span> = <span style="color: #f5deb3; font-weight: bold;">[</span>2,1,3<span style="color: #f5deb3; font-weight: bold;">]</span>
<span style="color: #268bd2;">L</span> = <span style="color: #f5deb3; font-weight: bold;">[</span>2,3,1<span style="color: #f5deb3; font-weight: bold;">]</span>
<span style="color: #268bd2;">L</span> = <span style="color: #f5deb3; font-weight: bold;">[</span>3,1,2<span style="color: #f5deb3; font-weight: bold;">]</span>
<span style="color: #268bd2;">L</span> = <span style="color: #f5deb3; font-weight: bold;">[</span>3,2,1<span style="color: #f5deb3; font-weight: bold;">]</span>

<span style="color: #268bd2;">permutation</span><span style="color: #f5deb3;">(</span> <span style="color: #b58900; font-weight: bold;">[</span>1, <span style="color: #268bd2;">A</span>, 3<span style="color: #b58900; font-weight: bold;">]</span>, <span style="color: #b58900; font-weight: bold;">[</span>3, 2, 1<span style="color: #b58900; font-weight: bold;">]</span> <span style="color: #f5deb3;">)</span>.

<span style="color: #268bd2;">A</span> = 2
</pre>
</div>

<p>
<i>Permutation</i>, in Prolog, can be defined in terms of <i>append</i>.
</p>
</div>
</div>


<div id="outline-container-sec-1-1-11" class="outline-4">
<h4 id="sec-1-1-11">Alchemy Facts: mapping ingredients to effects:</h4>
<div class="outline-text-4" id="text-1-1-11">
<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #586e75;">% </span><span style="color: #586e75;">-*- mode: prolog -*-</span>
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> abecean_longfin, fortify_restoration <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> abecean_longfin, fortify_sneak <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> abecean_longfin, weakness_to_frost <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> abecean_longfin, weakness_to_poison <span style="color: #f5deb3;">)</span>.

<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> ancestor_moth_wing, damage_magicka_regen <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> ancestor_moth_wing, damage_stamina <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> ancestor_moth_wing, fortify_conjuration <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> ancestor_moth_wing, fortify_enchanting <span style="color: #f5deb3;">)</span>.

<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> bear_claws, damage_magicka_regen <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> bear_claws, fortify_health <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> bear_claws, fortify_one_handed <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> bear_claws, restore_stamina <span style="color: #f5deb3;">)</span>.

<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> bee, ravage_stamina <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> bee, regenerate_stamina <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> bee, restore_stamina <span style="color: #f5deb3;">)</span>.
<span style="color: #268bd2;">effect</span><span style="color: #f5deb3;">(</span> bee, weakness_to_shock <span style="color: #f5deb3;">)</span>.
</pre>
</div>

<p>
and so on for all available ingredients.
</p>
</div>
</div>

<div id="outline-container-sec-1-1-12" class="outline-4">
<h4 id="sec-1-1-12">Rules for Mixing</h4>
<div class="outline-text-4" id="text-1-1-12">
<p>
A potion can be created if two ingredients are combined that share at least one effect:
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #268bd2;">potion</span><span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">IngredientA</span>, <span style="color: #268bd2;">IngredientB</span> <span style="color: #f5deb3;">)</span> :- potion<span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">IngredientA</span>, <span style="color: #268bd2;">IngredientB</span>, <span style="color: #268bd2;">_</span> <span style="color: #f5deb3;">)</span>.

<span style="color: #268bd2;">potion</span><span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">IngredientA</span>, <span style="color: #268bd2;">IngredientB</span>, <span style="color: #268bd2;">Effect</span> <span style="color: #f5deb3;">)</span> :-
    effect<span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">IngredientA</span>, <span style="color: #268bd2;">Effect</span> <span style="color: #f5deb3;">)</span>,
    effect<span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">IngredientB</span>, <span style="color: #268bd2;">Effect</span> <span style="color: #f5deb3;">)</span>,
    <span style="color: #268bd2;">IngredientA</span> \= <span style="color: #268bd2;">IngredientB</span>.
</pre>
</div>

<p>
Given a list of ingredients, what potions can be mixed?
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #268bd2;">mixes</span><span style="color: #f5deb3;">(</span> <span style="color: #b58900; font-weight: bold;">[]</span>, <span style="color: #268bd2;">_</span>, <span style="color: #268bd2;">_</span>, <span style="color: #268bd2;">_</span> <span style="color: #f5deb3;">)</span> :- fail.
<span style="color: #268bd2;">mixes</span><span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">L</span>, <span style="color: #268bd2;">Ia</span>, <span style="color: #268bd2;">Ib</span>, <span style="color: #268bd2;">E</span> <span style="color: #f5deb3;">)</span> :-
    permutation<span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">L</span>, <span style="color: #b58900; font-weight: bold;">[</span><span style="color: #268bd2;">Ia</span><span style="color: #859900; font-weight: bold;">|</span><span style="color: #268bd2; font-weight: bold;">[</span><span style="color: #268bd2;">Ib</span><span style="color: #859900; font-weight: bold;">|</span><span style="color: #268bd2;">_</span><span style="color: #268bd2; font-weight: bold;">]</span><span style="color: #b58900; font-weight: bold;">]</span> <span style="color: #f5deb3;">)</span>,
    potion<span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">Ia</span>, <span style="color: #268bd2;">Ib</span>, <span style="color: #268bd2;">E</span> <span style="color: #f5deb3;">)</span>.
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-13" class="outline-4">
<h4 id="sec-1-1-13">Running</h4>
<div class="outline-text-4" id="text-1-1-13">
<p>
Start the Prolog interpreter.  I'm using GNU Prolog here, but
others should work as well.
</p>

<p>
Next, load the code:
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #859900; font-weight: bold;">|</span> ?- consult<span style="color: #f5deb3;">(</span><span style="color: #2aa198;">'alchemy.pl'</span><span style="color: #f5deb3;">)</span>.
compiling alchemy.<span style="color: #268bd2;">pl</span> for byte code...
alchemy.<span style="color: #268bd2;">pl</span> compiled, 504 lines read - 51392 bytes written, 36 ms

<span style="color: #f5deb3;">(</span>9 ms<span style="color: #f5deb3;">)</span> yes
<span style="color: #859900; font-weight: bold;">|</span> ?-
</pre>
</div>

<p>
<code>| ?-</code> is the prolog prompt in this implementation.
</p>

<p>
Now we can try a query:
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #859900; font-weight: bold;">|</span> ?- potion<span style="color: #f5deb3;">(</span> wisp_wrappings, white_cap <span style="color: #f5deb3;">)</span>.

no
<span style="color: #859900; font-weight: bold;">|</span> ?-
</pre>
</div>

<p>
So, that combination returns no matches, i.e., those ingredients
do not mix to form a potion.
</p>

<p>
Let's try different ingredients:
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #859900; font-weight: bold;">|</span> ?- potion<span style="color: #f5deb3;">(</span> wheat, hanging_moss <span style="color: #f5deb3;">)</span>.

true ?
</pre>
</div>

<p>
This is Prolog telling us that those ingredients do mix.  The <code>?</code>
prompt is waiting for us to ask for more results, which we can do
by entering <code>;</code>:
</p>

<div class="org-src-container">

<pre class="src src-prolog">true ? <span style="color: #859900; font-weight: bold;">;</span>

no
<span style="color: #859900; font-weight: bold;">|</span> ?-
</pre>
</div>

<p>
Turns out that is the only result.
</p>

<p>
Let's imagine we're in dire need of a healing potion, what
ingredients can we use?
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #859900; font-weight: bold;">|</span> ?- potion<span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">A</span>, <span style="color: #268bd2;">B</span>, restore_health <span style="color: #f5deb3;">)</span>.

<span style="color: #268bd2;">A</span> = blisterwort
<span style="color: #268bd2;">B</span> = blue_dartwing ? <span style="color: #859900; font-weight: bold;">;</span>

<span style="color: #268bd2;">A</span> = blisterwort
<span style="color: #268bd2;">B</span> = blue_mountain_flower ? <span style="color: #859900; font-weight: bold;">;</span>
</pre>
</div>

<p>
â€¦and so on.
</p>

<p>
Maybe we have some wheat on hand, what can we combine it with?
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #859900; font-weight: bold;">|</span> ?- potion<span style="color: #f5deb3;">(</span> wheat, <span style="color: #268bd2;">Ingredient</span>, <span style="color: #268bd2;">Effect</span> <span style="color: #f5deb3;">)</span>.

<span style="color: #268bd2;">Effect</span> = damage_stamina_regen
<span style="color: #268bd2;">Ingredient</span> = creep_cluster ? <span style="color: #859900; font-weight: bold;">;</span>

<span style="color: #268bd2;">Effect</span> = damage_stamina_regen
<span style="color: #268bd2;">Ingredient</span> = daedra_heart ? <span style="color: #859900; font-weight: bold;">;</span>

<span style="color: #268bd2;">Effect</span> = damage_stamina_regen
<span style="color: #268bd2;">Ingredient</span> = frost_mirriam ? <span style="color: #859900; font-weight: bold;">;</span>

<span style="color: #268bd2;">Effect</span> = damage_stamina_regen
<span style="color: #268bd2;">Ingredient</span> = giants_toe ? <span style="color: #859900; font-weight: bold;">;</span>

<span style="color: #268bd2;">Effect</span> = damage_stamina_regen
<span style="color: #268bd2;">Ingredient</span> = histcarp ?

yes
<span style="color: #859900; font-weight: bold;">|</span> ?-
</pre>
</div>

<p>
I've got a bunch of ingredients, what can I make and sell?
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #859900; font-weight: bold;">|</span> ?- mixes<span style="color: #f5deb3;">(</span> <span style="color: #b58900; font-weight: bold;">[</span>wheat, vampire_dust, daedra_heart, troll_fat<span style="color: #b58900; font-weight: bold;">]</span>, <span style="color: #268bd2;">A</span>, <span style="color: #268bd2;">B</span>, <span style="color: #268bd2;">E</span> <span style="color: #f5deb3;">)</span>.

<span style="color: #268bd2;">A</span> = wheat
<span style="color: #268bd2;">B</span> = daedra_heart
<span style="color: #268bd2;">E</span> = damage_stamina_regen ? <span style="color: #859900; font-weight: bold;">;</span>

<span style="color: #268bd2;">A</span> = wheat
<span style="color: #268bd2;">B</span> = daedra_heart
<span style="color: #268bd2;">E</span> = restore_health ?

yes
</pre>
</div>

<p>
Another way to get ingredients for a particular potion:
</p>

<div class="org-src-container">

<pre class="src src-prolog"><span style="color: #859900; font-weight: bold;">|</span> ?- mixes<span style="color: #f5deb3;">(</span> <span style="color: #268bd2;">L</span>, <span style="color: #268bd2;">_</span>, <span style="color: #268bd2;">_</span>, restore_health <span style="color: #f5deb3;">)</span>.

<span style="color: #268bd2;">L</span> = <span style="color: #f5deb3; font-weight: bold;">[</span>blisterwort,blue_dartwing<span style="color: #f5deb3; font-weight: bold;">]</span> ? <span style="color: #859900; font-weight: bold;">;</span>

<span style="color: #268bd2;">L</span> = <span style="color: #f5deb3; font-weight: bold;">[</span>blisterwort,blue_mountain_flower<span style="color: #f5deb3; font-weight: bold;">]</span> ?

yes
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Haskell</h3>
<div class="outline-text-3" id="text-1-2">
<p>
In haskell, we can use list-comprehensions to perform similar sorts of searches.
</p>
</div>

<div id="outline-container-sec-1-2-1" class="outline-4">
<h4 id="sec-1-2-1">Facts</h4>
<div class="outline-text-4" id="text-1-2-1">
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #859900; font-weight: bold;">module</span> <span style="color: #b58900;">AlchemyFacts</span> <span style="color: #859900; font-weight: bold;">where</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Ingredient</span> <span style="color: #268bd2;">=</span> <span style="color: #b58900;">String</span>
<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Effect</span>     <span style="color: #268bd2;">=</span> <span style="color: #b58900;">String</span>
<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Property</span>   <span style="color: #268bd2;">=</span> <span style="color: #f5deb3;">(</span><span style="color: #b58900;">Ingredient</span>, <span style="color: #b58900;">Effect</span><span style="color: #f5deb3;">)</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Facts</span> <span style="color: #268bd2;">=</span> <span style="color: #f5deb3;">[</span><span style="color: #b58900;">Property</span><span style="color: #f5deb3;">]</span>
</pre>
</div>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #268bd2;">facts</span> <span style="color: #268bd2;">::</span> <span style="color: #b58900;">Facts</span>
<span style="color: #268bd2;">facts</span> <span style="color: #268bd2;">=</span> <span style="color: #f5deb3;">[</span>
  <span style="color: #b58900;">(</span><span style="color: #2aa198;">"Abecean Longfin"</span>, <span style="color: #2aa198;">"Fortify Restoration"</span><span style="color: #b58900;">)</span>,
  <span style="color: #b58900;">(</span><span style="color: #2aa198;">"Abecean Longfin"</span>, <span style="color: #2aa198;">"Fortify Sneak"</span><span style="color: #b58900;">)</span>,
  <span style="color: #b58900;">(</span><span style="color: #2aa198;">"Abecean Longfin"</span>, <span style="color: #2aa198;">"Weakness To Frost"</span><span style="color: #b58900;">)</span>,
  <span style="color: #b58900;">(</span><span style="color: #2aa198;">"Abecean Longfin"</span>, <span style="color: #2aa198;">"Weakness To Poison"</span><span style="color: #b58900;">)</span>,

  <span style="color: #b58900;">(</span><span style="color: #2aa198;">"Ancestor Moth Wing"</span>, <span style="color: #2aa198;">"Damage Magicka Regen"</span><span style="color: #b58900;">)</span>,
  <span style="color: #b58900;">(</span><span style="color: #2aa198;">"Ancestor Moth Wing"</span>, <span style="color: #2aa198;">"Damage Stamina"</span><span style="color: #b58900;">)</span>,
  <span style="color: #b58900;">(</span><span style="color: #2aa198;">"Ancestor Moth Wing"</span>, <span style="color: #2aa198;">"Fortify Conjuration"</span><span style="color: #b58900;">)</span>,
  <span style="color: #b58900;">(</span><span style="color: #2aa198;">"Ancestor Moth Wing"</span>, <span style="color: #2aa198;">"Fortify Enchanting"</span><span style="color: #b58900;">)</span>,

  <span style="color: #b58900;">(</span><span style="color: #2aa198;">"Bear Claws"</span>, <span style="color: #2aa198;">"Damage Magicka Regen"</span><span style="color: #b58900;">)</span>,
  <span style="color: #b58900;">(</span><span style="color: #2aa198;">"Bear Claws"</span>, <span style="color: #2aa198;">"Fortify Health"</span><span style="color: #b58900;">)</span>,
  <span style="color: #b58900;">(</span><span style="color: #2aa198;">"Bear Claws"</span>, <span style="color: #2aa198;">"Fortify One Handed"</span><span style="color: #b58900;">)</span>,
  <span style="color: #b58900;">(</span><span style="color: #2aa198;">"Bear Claws"</span>, <span style="color: #2aa198;">"Restore Stamina"</span><span style="color: #b58900;">)</span>,
  <span style="color: #586e75;">-- </span><span style="color: #586e75;">&#8230;</span>
</pre>
</div>

<p>
To check if two ingredients can mix:
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #859900; font-weight: bold;">module</span> <span style="color: #b58900;">Alchemy</span> <span style="color: #859900; font-weight: bold;">where</span>
<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #b58900;">Data.List</span>  <span style="color: #586e75;">-- </span><span style="color: #586e75;">for nub (unique list)</span>
<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #b58900;">AlchemyFacts</span>

<span style="color: #268bd2;">ingredients</span> <span style="color: #268bd2;">=</span> nub <span style="color: #f5deb3;">[</span>i <span style="color: #268bd2;">|</span> <span style="color: #b58900;">(</span>i, <span style="color: #859900; font-weight: bold;">_</span><span style="color: #b58900;">)</span> <span style="color: #268bd2;">&lt;-</span> facts<span style="color: #f5deb3;">]</span>
<span style="color: #268bd2;">effects</span>     <span style="color: #268bd2;">=</span> nub <span style="color: #f5deb3;">[</span>e <span style="color: #268bd2;">|</span> <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">_</span>, e<span style="color: #b58900;">)</span> <span style="color: #268bd2;">&lt;-</span> facts<span style="color: #f5deb3;">]</span>

<span style="color: #268bd2;">potion</span> <span style="color: #268bd2;">::</span> <span style="color: #b58900;">Ingredient</span> <span style="color: #268bd2;">-&gt;</span> <span style="color: #b58900;">Ingredient</span> <span style="color: #268bd2;">-&gt;</span> <span style="color: #f5deb3;">[</span><span style="color: #b58900;">Effect</span><span style="color: #f5deb3;">]</span>
<span style="color: #268bd2;">potion</span> a b <span style="color: #268bd2;">=</span> <span style="color: #f5deb3;">[</span>e <span style="color: #268bd2;">|</span>
              <span style="color: #b58900;">(</span>i, e<span style="color: #b58900;">)</span> <span style="color: #268bd2;">&lt;-</span> facts,
              <span style="color: #b58900;">(</span>i', e'<span style="color: #b58900;">)</span> <span style="color: #268bd2;">&lt;-</span> facts,
              e <span style="color: #268bd2;">==</span> e',
              i <span style="color: #268bd2;">==</span> a,
              i' <span style="color: #268bd2;">==</span> b<span style="color: #f5deb3;">]</span>
</pre>
</div>

<p>
The interface for this function is a bit different than the Prolog
implementation in that it returns list of <code>Effects</code>.
</p>

<p>
Running this code in GHCi, I get:
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #b58900;">GHCi</span>, version 7<span style="color: #268bd2;">.</span>4<span style="color: #268bd2;">.</span>1<span style="color: #b58900;">:</span> http<span style="color: #b58900;">://</span>www<span style="color: #268bd2;">.</span>haskell<span style="color: #268bd2;">.</span>org<span style="color: #268bd2;">/</span>ghc<span style="color: #268bd2;">/</span>  <span style="color: #b58900;">:?</span> for help
<span style="color: #b58900;">Prelude</span><span style="color: #268bd2;">&gt;</span> <span style="color: #b58900;">:</span>load alchemy
<span style="color: #f5deb3;">[</span>1 <span style="color: #859900; font-weight: bold;">of</span> 2<span style="color: #f5deb3;">]</span> <span style="color: #b58900;">Compiling</span> <span style="color: #b58900;">AlchemyFacts</span>     <span style="color: #f5deb3;">(</span> <span style="color: #DADADA; background-color: #211E1E;">AlchemyFacts.hs</span>, interpreted <span style="color: #f5deb3;">)</span>
<span style="color: #f5deb3;">[</span>2 <span style="color: #859900; font-weight: bold;">of</span> 2<span style="color: #f5deb3;">]</span> <span style="color: #b58900;">Compiling</span> <span style="color: #b58900;">Alchemy</span>          <span style="color: #f5deb3;">(</span> alchemy<span style="color: #268bd2;">.</span>hs, interpreted <span style="color: #f5deb3;">)</span>
<span style="color: #b58900;">Ok</span>, modules loaded<span style="color: #b58900;">:</span> <span style="color: #b58900;">AlchemyFacts</span>, <span style="color: #b58900;">Alchemy</span><span style="color: #268bd2;">.</span>
<span style="color: #268bd2;">*</span><span style="color: #b58900;">Alchemy</span><span style="color: #268bd2;">&gt;</span> <span style="color: #b58900;">:</span>t ingredients
<span style="color: #268bd2;">ingredients</span> <span style="color: #268bd2;">::</span> <span style="color: #f5deb3;">[</span><span style="color: #b58900;">Ingredient</span><span style="color: #f5deb3;">]</span>
<span style="color: #268bd2;">*</span><span style="color: #b58900;">Alchemy</span><span style="color: #268bd2;">&gt;</span> <span style="color: #b58900;">:</span>t effects
<span style="color: #268bd2;">effects</span> <span style="color: #268bd2;">::</span> <span style="color: #f5deb3;">[</span><span style="color: #b58900;">Effect</span><span style="color: #f5deb3;">]</span>
<span style="color: #268bd2;">*</span><span style="color: #b58900;">Alchemy</span><span style="color: #268bd2;">&gt;</span> potion <span style="color: #2aa198;">"Wheat"</span> <span style="color: #2aa198;">"Daedra Heart"</span>
<span style="color: #f5deb3;">[</span><span style="color: #2aa198;">"Damage Stamina Regen"</span>,<span style="color: #2aa198;">"Restore Health"</span><span style="color: #f5deb3;">]</span>
</pre>
</div>

<p>
In Haskell, unlike Prolog, we don't get automatic reverse
execution.  So, we'll need another function to search for
ingredients with a given <code>Effect</code>.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #268bd2;">withEffect</span> <span style="color: #268bd2;">::</span> <span style="color: #b58900;">Effect</span> <span style="color: #268bd2;">-&gt;</span> <span style="color: #f5deb3;">[</span><span style="color: #b58900;">Ingredient</span><span style="color: #f5deb3;">]</span>
<span style="color: #268bd2;">withEffect</span> e <span style="color: #268bd2;">=</span> nub <span style="color: #f5deb3;">[</span>i <span style="color: #268bd2;">|</span> <span style="color: #b58900;">(</span>i, e'<span style="color: #b58900;">)</span> <span style="color: #268bd2;">&lt;-</span> facts, e <span style="color: #268bd2;">==</span> e'<span style="color: #f5deb3;">]</span>
</pre>
</div>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #268bd2;">*</span><span style="color: #b58900;">Alchemy</span><span style="color: #268bd2;">&gt;</span> withEffect <span style="color: #2aa198;">"Frenzy"</span>
<span style="color: #f5deb3;">[</span><span style="color: #2aa198;">"Blisterwort"</span>,<span style="color: #2aa198;">"Falmer Ear"</span>,<span style="color: #2aa198;">"Fly Amanita"</span>,<span style="color: #2aa198;">"Hagraven Feathers"</span>,<span style="color: #2aa198;">"Human Heart"</span>,<span style="color: #2aa198;">"Troll Fat"</span><span style="color: #f5deb3;">]</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://www.learnprolognow.org"><i>Learn Prolog Now</i></a>
</p></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Toby Tripp</p>
<p class="date">Created: 2015-02-22 Sun 12:26</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.3.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
